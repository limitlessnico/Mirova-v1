<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mirova-OVDAS VRP Interactive Monitor</title>
    <style>
        :root {
            --bg-color: #0b0e14;
            --card-bg: #161b22;
            --text-color: #e0e0e0;
            --accent-color: #58a6ff;
            --border-color: #30363d;
        }
        body { 
            background-color: var(--bg-color); color: var(--text-color); 
            font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; 
            display: flex; flex-direction: column; min-height: 100vh; 
        }
        #audit-bar { 
            background: var(--card-bg); padding: 12px 25px; 
            border-bottom: 1px solid var(--border-color); 
            display: flex; justify-content: space-between; align-items: center; 
        }
        .status-badge { padding: 4px 12px; border-radius: 20px; font-weight: bold; border: 1px solid var(--border-color); background: #0d1117; }
        .dashboard-wrapper { flex: 1; display: flex; padding: 20px; }
        .iframe-container { width: 100%; border-radius: 8px; overflow: hidden; background: var(--card-bg); border: 1px solid var(--border-color); }
        iframe { width: 100%; height: 85vh; border: none; }
    </style>
</head>
<body>
    <div id="audit-bar">
        <div><strong>ESTADO DEL SISTEMA:</strong> <span id="sys-status" class="status-badge">REVISANDO...</span></div>
        <div>ÚLTIMA SINCRONIZACIÓN: <span id="last-sync">--:--</span></div>
    </div>

    <main class="dashboard-wrapper">
        <div class="iframe-container">
            <iframe id="plotly-frame" src="monitoreo_satelital/dashboard_interactivo.html"></iframe>
        </div>
    </main>

    <script>
        function checkAudit() {
            fetch('monitoreo_satelital/estado_sistema.json?t=' + new Date().getTime())
            .then(res => res.json())
            .then(data => {
                document.getElementById('sys-status').innerText = data.estado;
                document.getElementById('sys-status').style.color = data.color;
                document.getElementById('last-sync').innerText = data.ultima_actualizacion;
                
                const frame = document.getElementById('plotly-frame');
                frame.src = 'monitoreo_satelital/dashboard_interactivo.html?t=' + new Date().getTime();
            })
            .catch(() => { document.getElementById('sys-status').innerText = "⚪ SINCRONIZANDO..."; });
        }
        document.addEventListener('DOMContentLoaded', checkAudit);
        setInterval(checkAudit, 300000);
    </script>
</body>
</html>
